# é«˜çº§æœºå™¨å­¦ä¹ ç†è®ºè¯¾ç¨‹ä½œä¸šâ€”â€”åŸºäºCLIPçš„å°æ ·æœ¬åˆ†å¸ƒå¤–æ£€æµ‹

<div align="center">
  
![Python](https://img.shields.io/badge/Python-3.9.20-blue.svg)
![PyTorch](https://img.shields.io/badge/PyTorch-2.2.1-orange.svg)
![License](https://img.shields.io/badge/License-MIT-green.svg)

</div>

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®ä¸ºåä¸­ç§‘æŠ€å¤§å­¦äººå·¥æ™ºèƒ½ä¸è‡ªåŠ¨åŒ–å­¦é™¢ç ”ç©¶ç”Ÿè¯¾ç¨‹ã€Šé«˜çº§æœºå™¨å­¦ä¹ ç†è®ºã€‹çš„è¯¾ç¨‹ä½œä¸šï¼Œä¸“æ³¨äºåŸºäºCLIPçš„å°æ ·æœ¬**åˆ†å¸ƒå¤–æ£€æµ‹**ï¼ˆOut-of-Distribution Detectionï¼‰é—®é¢˜ã€‚

![LoCoOp](fig/LoCoOp.png)

## ğŸ‘¨â€ğŸ“ ä½œè€…ä¿¡æ¯

|  |  |
|:---:|:---:|
| **é¢˜ç›®** | åŸºäºCLIPçš„å°æ ·æœ¬åˆ†å¸ƒå¤–æ£€æµ‹ |
| **å­¦å·** | U202115210ï¼ˆæœ¬ç§‘ç”Ÿï¼‰ |
| **å§“å** | æ¢ä¸€å‡¡ |
| **ä¸“ä¸š** | äººå·¥æ™ºèƒ½æœ¬ç¡•åš2101ç­ |
| **æŒ‡å¯¼æ•™å¸ˆ** | ä¼å†¬ç¿ã€æœ±åŠ›å†› |
| **é™¢ç³»** | äººå·¥æ™ºèƒ½ä¸è‡ªåŠ¨åŒ–å­¦é™¢ |
| **QQ** | 879059433 |
|  |  |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå¹¶å…‹éš†ä»“åº“
é¦–å…ˆå…‹éš†å¹¶å®‰è£… dassl åº“

```bash
# åˆ›å»ºcondaç¯å¢ƒ
conda create -n clipood python=3.9
conda activate clipood

# å®‰è£…PyToch
conda install pytorch==2.2.1 torchvision==0.17.1 torchaudio==2.2.1 pytorch-cuda=12.1 -c pytorch -c nvidia

# å…‹éš†å¹¶å®‰è£…dasslåº“
git clone https://github.com/KaiyangZhou/Dassl.pytorch.git
cd Dassl.pytorch/
python setup.py develop
cd ..

# å…‹éš†æœ¬ä»“åº“
git clone https://github.com/YifanLiang-hust/Advanced_ML_Final_Project.git
cd Advanced_ML_Final_Project

# å®‰è£…é¡¹ç›®ä¾èµ–åŒ…
pip install -r requirements.txt
```

## ğŸ“¦ é¢„è®­ç»ƒæ¨¡å‹

æœ¬é¡¹ç›®ä½¿ç”¨ä»¥ä¸‹é¢„è®­ç»ƒæ¨¡å‹ï¼š

- **CLIP ViT-B/16**


é¢„è®­ç»ƒæƒé‡ä¸‹è½½åœ°å€ï¼šhttps://pan.baidu.com/s/1_Fqp-pTaQTdrsKc6YhFV7A?pwd=6bmp

## ğŸ“Š æ•°æ®é›†
éµå¾ªMOSä¸­çš„è®¾ç½®ï¼Œæœ¬é¡¹ç›®é‡‡ç”¨å¦‚ä¸‹æµ‹è¯•åŸºå‡†ï¼š
![MOSæµ‹è¯•åŸºå‡†](fig/MOS.png)

### ID æ•°æ®é›†

- **ImageNet-1K**ï¼šåŒ…å«1000ä¸ªç±»åˆ«çš„å›¾åƒåˆ†ç±»æ•°æ®é›†ï¼Œåœ¨å°æ ·æœ¬è®­ç»ƒä¸­æ¯ç±»é‡‡æ ·1ã€2ã€4ã€8ã€16ä¸ªæ ·æœ¬ï¼Œå…¶ç±»åˆ«åä¸ç¼–å·çš„å¯¹åº”å…³ç³»è§ç½‘ç›˜ä¸­çš„classname.txt

æ•°æ®é›†ä¸‹è½½åœ°å€ï¼šhttps://image-net.org/, æˆ–è€…å„ç§å¹³å°æ¡†æ¶éƒ½æœ‰è¯¥æ•°æ®é›†

### OOD æ•°æ®é›†
OODæ•°æ®é›†ä¸­å·²ç»å‰”é™¤äº†ä¸ ID æ•°æ®é›†ä¸­é‡å çš„ç±»åˆ«ï¼Œ
- **iNaturalist**ï¼šè‡ªç„¶ç‰©ç§å›¾åƒæ•°æ®é›†ï¼Œå…±10,000å¼ 
- **SUN**ï¼šåœºæ™¯ç†è§£æ•°æ®é›†ï¼Œå…±10,000å¼ 
- **Places**ï¼šåœºæ™¯åˆ†ç±»æ•°æ®é›†ï¼Œå…±10,000å¼ 
- **Texture**ï¼šçº¹ç†å›¾åƒæ•°æ®é›†ï¼Œå…±5,640å¼ 

æ•°æ®é›†ä¸‹è½½åœ°å€ï¼šhttps://pan.baidu.com/s/1_Fqp-pTaQTdrsKc6YhFV7A?pwd=6bmp

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
Advanced_ML_Final_Project/
â”‚
â”œâ”€â”€ clip/
â”œâ”€â”€ clip_w_local/
â”œâ”€â”€ fig/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ ID/
â”‚       â”œâ”€â”€ ImageNet/
â”‚           â”œâ”€â”€ classnames.txt
â”‚           â”œâ”€â”€ preprocessed.pkl(è¿è¡Œè®­ç»ƒä»£ç åè‡ªåŠ¨ç”Ÿæˆ)
â”‚           â”œâ”€â”€ train/
â”‚               â”œâ”€â”€ n01440764/
â”‚               â”œâ”€â”€ ...
â”‚           â”œâ”€â”€ val/
â”‚               â”œâ”€â”€ n01440764/
â”‚               â”œâ”€â”€ ...
â”‚           â”œâ”€â”€ split_fewshot/
â”‚               â”œâ”€â”€ shot_1-seed_1.pkl(æ ¹æ®å…·ä½“è¿è¡Œè®¾ç½®è‡ªåŠ¨ç”Ÿæˆ)
â”‚               â”œâ”€â”€ ...
â”‚
â”œâ”€â”€ dataset/            # æ•°æ®é›†å¤„ç†ä»£ç 
â”‚   â”œâ”€â”€ imagenet.py
â”œâ”€â”€ trainer/            # è®­ç»ƒå™¨
â”‚   â”œâ”€â”€ dpcoop.py
â”‚   â”œâ”€â”€ dplocoop.py
â”‚   â”œâ”€â”€ dpsct.py
â”œâ”€â”€ utils/              # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ detection_util.py
â”œâ”€â”€ config/             # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ dataset/
â”‚       â”œâ”€â”€ imagenet.yaml
â”‚   â”œâ”€â”€ trainer/
â”‚       â”œâ”€â”€ ImageNet_b16.yaml
â”œâ”€â”€ script/             # è¿è¡Œè„šæœ¬
â”‚   â”œâ”€â”€ DPCOOP/
â”‚       â”œâ”€â”€ train_and_eval.sh
â”‚   â”œâ”€â”€ DPLOCOOP/
â”‚       â”œâ”€â”€ train_and_eval.sh
â”‚   â”œâ”€â”€ DPSCT/
â”‚       â”œâ”€â”€ train_and_eval.sh
â”‚
â”œâ”€â”€ CoOp_main.py         # ä¸»å‡½æ•°
â”œâ”€â”€ requirements.txt     # ä¾èµ–åŒ…åˆ—è¡¨
â””â”€â”€ README.md            # é¡¹ç›®è¯´æ˜
```

## ğŸ“ ä½¿ç”¨æ–¹æ³•

### è®­ç»ƒä¸è¯„ä¼°

```bash
bash ./script/DPCoOp/train_and_eval.sh

bash ./script/DPLoCoOp/train_and_eval.sh

bash ./script/DPSCT/train_and_eval.sh
```

### å¯è§†åŒ–ç›¸å…³

```bash
å¾…è¡¥å……
```

## ğŸ“Š å®éªŒç»“æœ
å¾…è¡¥å……
<!-- ### å„æ•°æ®é›†æ€§èƒ½å¯¹æ¯”

| æ¨¡å‹ | iNaturalist |  | SUN |  | Places |  | Texture |  | å¹³å‡ |  |
|:---|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
|  | AUROCâ†‘ | FPR95â†“ | AUROCâ†‘ | FPR95â†“ | AUROCâ†‘ | FPR95â†“ | AUROCâ†‘ | FPR95â†“ | AUROCâ†‘ | FPR95â†“ |
| CLIP ViT-B/16 | 94.8% | 9.2% | 95.5% | 8.5% | 94.9% | 9.1% | 95.6% | 8.0% | 95.2% | 8.7% |
| CLIP ViT-B/32 | 94.2% | 10.7% | 94.7% | 9.9% | 94.1% | 10.8% | 95.0% | 9.4% | 94.5% | 10.2% |
| æˆ‘ä»¬çš„æ–¹æ³• | **96.9%** | **5.5%** | **97.2%** | **5.0%** | **96.8%** | **5.7%** | **97.5%** | **5.0%** | **97.1%** | **5.3%** | -->

## âœ¨ è‡´è°¢

æ„Ÿè°¢åä¸­ç§‘æŠ€å¤§å­¦äººå·¥æ™ºèƒ½ä¸è‡ªåŠ¨åŒ–å­¦é™¢æä¾›çš„å­¦ä¹ å¹³å°å’Œèµ„æºæ”¯æŒ

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT License å¼€æºè®¸å¯è¯

---

<div align="center">Â© 2025 æ¢ä¸€å‡¡ - åä¸­ç§‘æŠ€å¤§å­¦ï¼Œäººå·¥æ™ºèƒ½ä¸è‡ªåŠ¨åŒ–å­¦é™¢</div>
